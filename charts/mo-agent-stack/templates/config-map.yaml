apiVersion: v1
data:
  mo-agent.yaml: |-
    log:
      level: {{ .Values.moAgent.agentSpec.log.level }}
      format: {{ .Values.moAgent.agentSpec.log.format }}
      filename: {{ .Values.moAgent.agentSpec.log.filename }}
      maxSize: {{ .Values.moAgent.agentSpec.log.maxSize }}
      maxDays: {{ .Values.moAgent.agentSpec.log.maxDays }}
      maxBackups: {{ .Values.moAgent.agentSpec.log.maxBackups }}
    general:
      shortTable: {{ .Values.moAgent.agentSpec.general.shortTable }}
    agent: 
      server:
        host: {{ .Values.moAgent.agentSpec.server.host }}
        port: {{ .Values.moAgent.agentSpec.server.port }}
        privateKeyFile: {{ .Values.moAgent.agentSpec.server.privateKeyFile }}
        publicKeyFile: {{ .Values.moAgent.agentSpec.server.publicKeyFile }}
        tokenEffectiveTime: {{ .Values.moAgent.agentSpec.server.tokenEffectiveTime }}
        certPath: {{ .Values.moAgent.agentSpec.server.certPath }}
        mode: {{ .Values.moAgent.agentSpec.server.mode }}
      
      app:
        uuid: {{ .Values.moAgent.agentSpec.app.uuid }}
        account: {{ .Values.moAgent.agentSpec.app.account }}
        database: {{ .Values.moAgent.agentSpec.app.database }}
        extension: {{ .Values.moAgent.agentSpec.app.extension }}
        exporter: {{ .Values.moAgent.agentSpec.app.exporter }}
        exportThreads: {{ .Values.moAgent.agentSpec.app.exportThreads }}
        exportInterval: {{ .Values.moAgent.agentSpec.app.exportInterval }}
        bufferBytes: {{ .Values.moAgent.agentSpec.app.bufferBytes }}
        showAccessLog: {{ .Values.moAgent.agentSpec.app.showAccessLog }}
        queueSize : {{ .Values.moAgent.agentSpec.app.queueSize }}
        metricCacheSize : {{ .Values.moAgent.agentSpec.app.metricCacheSize }}
        labelCacheSize : {{ .Values.moAgent.agentSpec.app.labelCacheSize }}
        logCacheSize : {{ .Values.moAgent.agentSpec.app.logCacheSize }}
        preCreatetableWorker : {{ .Values.moAgent.agentSpec.app.preCreatetableWorker }}
        labelPreloadLimit : {{ .Values.moAgent.agentSpec.app.labelPreloadLimit }}
        labelFlushSize: {{ .Values.moAgent.agentSpec.app.labelFlushSize }}
        labelFlushInterval: {{ .Values.moAgent.agentSpec.app.labelFlushInterval }}
        metricTablesPreCreate: {{- range .Values.moAgent.agentSpec.app.metricTablesPreCreate }}
        - {{.}}{{- end }}

      fs:
        name: {{ .Values.moAgent.agentSpec.fs.name }}
        backend: {{ .Values.moAgent.agentSpec.fs.backend }}
        dataDir: {{ .Values.moAgent.agentSpec.fs.dataDir }}
        s3:
          endpoint: {{ .Values.moAgent.agentSpec.fs.s3.endpoint }}
          bucket: {{ .Values.moAgent.agentSpec.fs.s3.bucket }}
          keyPrefix: {{ .Values.moAgent.agentSpec.fs.s3.keyPrefix }}
      
      mo:
        host: {{ .Values.moAgent.agentSpec.mo.host }}
        port: {{ .Values.moAgent.agentSpec.mo.port }}
        user: {{ .Values.moAgent.agentSpec.mo.user }}
        password: {{ .Values.moAgent.agentSpec.mo.password }}
        connectTimeout: {{ .Values.moAgent.agentSpec.mo.connectTimeout }}
        maxOpens: {{ .Values.moAgent.agentSpec.mo.maxOpens }}
        maxIdles: {{ .Values.moAgent.agentSpec.mo.maxIdles }}
        initPingCnt: {{ .Values.moAgent.agentSpec.mo.initPingCnt }}

kind: ConfigMap
metadata:
  name: mo-agent-config-map
